import{d as K,N as M,r as V,c as Q,y as R,O as G,H as W,e as c,o as y,f as x,g as e,h as n,w as l,A as L,m as A,j as f,F as X,q as Y,v as z,t as I,B,z as S,P as Z,K as _,Q as ee}from"./index-afa834e1.js";const te=["onClick"],se=K({__name:"index",setup(ae){let p=M(),v=V([]),u=V(0),t=Q({attrName:"",attrValueList:[],categoryId:"",categoryLevel:3}),b=V([]);R(()=>p.c3Id,()=>{v.value=[],p.c3Id&&N()});const N=async()=>{const{c1Id:a,c2Id:i,c3Id:g}=p;let s=await G(a,i,g);s.code==200&&(v.value=s.data)},O=()=>{Object.assign(t,{attrName:"",attrValueList:[],categoryId:p.c3Id,categoryLevel:3}),u.value=1},U=a=>{u.value=1,Object.assign(t,JSON.parse(JSON.stringify(a)))},k=()=>{u.value=0},$=()=>{t.attrValueList.push({valueName:"",flag:!0}),S(()=>{b.value[t.attrValueList.length-1].focus()})},q=a=>{console.log(a),t.attrValueList.splice(a,1)},w=async()=>{(await Z(t)).code==200?(u.value=0,_({type:"success",message:t.id?"修改成功":"添加成功"}),N()):_({type:"error",message:t.id?"修改失败":"添加失败"})},D=(a,i)=>{if(a.valueName.trim()==""){t.attrValueList.splice(i,1),_({type:"error",message:"属性值不能为空"});return}if(t.attrValueList.find(s=>{if(s!=a)return s.valueName===a.valueName})){t.attrValueList.splice(i,1),_({type:"error",message:"属性值不能重复"});return}a.flag=!1},E=(a,i)=>{a.flag=!0,S(()=>{b.value[i].focus()})},P=async a=>{(await ee(a)).code==200?(_({type:"success",message:"删除成功"}),N()):_({type:"error",message:"删除失败"})};return W(()=>{p.$reset()}),(a,i)=>{const g=c("Category"),s=c("el-button"),d=c("el-table-column"),j=c("el-tag"),F=c("el-popconfirm"),C=c("el-table"),h=c("el-input"),J=c("el-form-item"),T=c("el-form"),H=c("el-card");return y(),x("div",null,[e(g,{scene:n(u)},null,8,["scene"]),e(H,{style:{margin:"10px 0px"}},{default:l(()=>[L(A("div",null,[e(s,{onClick:O,type:"primary",size:"default",icon:"Plus",disabled:!n(p).c3Id},{default:l(()=>[f("添加属性")]),_:1},8,["disabled"]),e(C,{border:"",style:{margin:"10px 0px"},data:n(v)},{default:l(()=>[e(d,{label:"序号",type:"index",align:"center",width:"80px"}),e(d,{label:"属性名称",width:"120px",prop:"attrName"}),e(d,{label:"属性值名称"},{default:l(({row:r,$index:m})=>[(y(!0),x(X,null,Y(r.attrValueList,(o,le)=>(y(),z(j,{style:{margin:"5px"},key:o.id},{default:l(()=>[f(I(o.valueName),1)]),_:2},1024))),128))]),_:1}),e(d,{label:"操作",width:"120px"},{default:l(({row:r,$index:m})=>[e(s,{type:"primary",size:"small",icon:"Edit",onClick:o=>U(r)},null,8,["onClick"]),e(F,{title:`你确定删除${r.attrName}?`,width:"200px",onConfirm:o=>P(r.id)},{reference:l(()=>[e(s,{type:"primary",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"])],512),[[B,n(u)==0]]),L(A("div",null,[e(T,{inline:!0},{default:l(()=>[e(J,{label:"属性名称"},{default:l(()=>[e(h,{placeholder:"请你输入属性名称",modelValue:n(t).attrName,"onUpdate:modelValue":i[0]||(i[0]=r=>n(t).attrName=r)},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{onClick:$,disabled:!n(t).attrName,type:"primary",size:"default",icon:"Plus"},{default:l(()=>[f("添加属性值")]),_:1},8,["disabled"]),e(s,{type:"primary",size:"default",onClick:k},{default:l(()=>[f("取消")]),_:1}),e(C,{border:"",style:{margin:"10px 0px"},data:n(t).attrValueList},{default:l(()=>[e(d,{label:"序号",width:"80px",type:"index",align:"center"}),e(d,{label:"属性值名称"},{default:l(({row:r,$index:m})=>[r.flag?(y(),z(h,{key:0,ref:o=>n(b)[m]=o,onBlur:o=>D(r,m),size:"small",placeholder:"请你输入属性值名称",modelValue:r.valueName,"onUpdate:modelValue":o=>r.valueName=o},null,8,["onBlur","modelValue","onUpdate:modelValue"])):(y(),x("div",{key:1,onClick:o=>E(r,m)},I(r.valueName),9,te))]),_:1}),e(d,{label:"属性值操作"},{default:l(({row:r,$index:m})=>[e(s,{type:"primary",size:"small",icon:"Delete",onClick:o=>q(m)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),e(s,{type:"primary",size:"default",onClick:w,disabled:!(n(t).attrValueList.length>0&&n(t).attrName.trim()!="")},{default:l(()=>[f("保存")]),_:1},8,["disabled"]),e(s,{type:"primary",size:"default",onClick:k},{default:l(()=>[f("取消")]),_:1})],512),[[B,n(u)==1]])]),_:1})])}}});export{se as default};
